<!DOCTYPE html>
<html>
<head>
    <title>Democracy Index Clustering Analysis</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .chart { width: 100%; height: 600px; margin-bottom: 40px; }
        h1, h2 { color: #333; }
        .controls { margin-bottom: 20px; padding: 15px; background: #f5f5f5; border-radius: 4px; }
        select, button { padding: 8px; margin-right: 10px; }
    </style>
</head>
<body>
    <h1>Democracy Index Clustering Analysis</h1>
    
    <div class="controls">
        <select id="colorby">
            <option value="cluster">Color by Cluster</option>
            <option value="category">Color by Original Category</option>
        </select>
        <button id="reset">Reset View</button>
    </div>
    
    <h2>K-Means Clustering Results</h2>
    <div id="cluster-chart" class="chart"></div>
    
    <h2>Feature Importance</h2>
    <div id="importance-chart" class="chart"></div>
    
    <h2>Comparison with Expert Classifications</h2>
    <div id="ari-chart" class="chart"></div>
    
    <script>
        // Sample data - you would replace this with your actual data
        const countries = [
            {country: "Norway", electoral_process: 10.00, functioning_government: 9.64, political_participation: 10.00, political_culture: 10.00, civil_liberties: 9.71, cluster: 2, original_category: "Full democracy"},
            {country: "Iceland", electoral_process: 10.00, functioning_government: 9.29, political_participation: 8.89, political_culture: 10.00, civil_liberties: 9.71, cluster: 2, original_category: "Full democracy"},
            {country: "Sweden", electoral_process: 9.58, functioning_government: 9.64, political_participation: 8.33, political_culture: 10.00, civil_liberties: 9.41, cluster: 2, original_category: "Full democracy"},
            {country: "New Zealand", electoral_process: 10.00, functioning_government: 9.29, political_participation: 8.89, political_culture: 8.13, civil_liberties: 10.00, cluster: 2, original_category: "Full democracy"},
            {country: "United States", electoral_process: 9.17, functioning_government: 7.14, political_participation: 7.78, political_culture: 7.50, civil_liberties: 8.24, cluster: 3, original_category: "Flawed democracy"},
            {country: "France", electoral_process: 9.58, functioning_government: 7.50, political_participation: 7.78, political_culture: 5.63, civil_liberties: 8.53, cluster: 3, original_category: "Flawed democracy"},
            {country: "South Korea", electoral_process: 9.17, functioning_government: 7.86, political_participation: 7.22, political_culture: 7.50, civil_liberties: 8.24, cluster: 3, original_category: "Flawed democracy"},
            {country: "Tunisia", electoral_process: 6.42, functioning_government: 5.71, political_participation: 7.78, political_culture: 6.25, civil_liberties: 5.88, cluster: 0, original_category: "Flawed democracy"},
            {country: "Ukraine", electoral_process: 6.17, functioning_government: 3.21, political_participation: 6.67, political_culture: 6.25, civil_liberties: 6.18, cluster: 0, original_category: "Hybrid regime"},
            {country: "Georgia", electoral_process: 7.83, functioning_government: 3.57, political_participation: 6.11, political_culture: 4.38, civil_liberties: 5.59, cluster: 0, original_category: "Hybrid regime"},
            {country: "Hungary", electoral_process: 8.75, functioning_government: 6.07, political_participation: 5.00, political_culture: 6.25, civil_liberties: 7.06, cluster: 0, original_category: "Flawed democracy"},
            {country: "Russia", electoral_process: 2.17, functioning_government: 1.79, political_participation: 5.00, political_culture: 2.50, civil_liberties: 3.24, cluster: 1, original_category: "Authoritarian"},
            {country: "China", electoral_process: 0.00, functioning_government: 5.00, political_participation: 3.89, political_culture: 6.25, civil_liberties: 1.47, cluster: 1, original_category: "Authoritarian"},
            {country: "Saudi Arabia", electoral_process: 0.00, functioning_government: 2.86, political_participation: 2.22, political_culture: 3.13, civil_liberties: 1.47, cluster: 1, original_category: "Authoritarian"},
            {country: "North Korea", electoral_process: 0.00, functioning_government: 2.50, political_participation: 1.67, political_culture: 1.25, civil_liberties: 0.00, cluster: 1, original_category: "Authoritarian"}
        ];
        
        // Define colors and names for clusters and categories
        const clusterColors = ['#FFC107', '#F44336', '#4CAF50', '#2196F3'];
        const clusterNames = ['Hybrid Regime', 'Authoritarian', 'Full Democracy', 'Flawed Democracy'];
        
        const categoryColors = {
            'Full democracy': '#4CAF50',
            'Flawed democracy': '#2196F3',
            'Hybrid regime': '#FFC107',
            'Authoritarian': '#F44336'
        };
        
        // Function to create scatter plot
        function createScatterPlot(colorBy = 'cluster') {
            const traces = [];
            
            if (colorBy === 'cluster') {
                // Group by clusters
                for (let i = 0; i < 4; i++) {
                    const clusterData = countries.filter(d => d.cluster === i);
                    traces.push({
                        x: clusterData.map(d => d.electoral_process),
                        y: clusterData.map(d => d.functioning_government),
                        text: clusterData.map(d => `<b>${d.country}</b><br>Electoral Process: ${d.electoral_process}<br>Functioning of Gov: ${d.functioning_government}`),
                        mode: 'markers',
                        name: clusterNames[i],
                        marker: {
                            size: 12,
                            color: clusterColors[i]
                        },
                        type: 'scatter',
                        hoverinfo: 'text'
                    });
                }
            } else {
                // Group by original categories
                const categories = [...new Set(countries.map(d => d.original_category))];
                categories.forEach(category => {
                    const categoryData = countries.filter(d => d.original_category === category);
                    traces.push({
                        x: categoryData.map(d => d.electoral_process),
                        y: categoryData.map(d => d.functioning_government),
                        text: categoryData.map(d => `<b>${d.country}</b><br>Electoral Process: ${d.electoral_process}<br>Functioning of Gov: ${d.functioning_government}`),
                        mode: 'markers',
                        name: category,
                        marker: {
                            size: 12,
                            color: categoryColors[category]
                        },
                        type: 'scatter',
                        hoverinfo: 'text'
                    });
                });
            }
            
            Plotly.newPlot('cluster-chart', traces, {
                title: 'Democracy Index K-Means Clustering',
                xaxis: { title: 'Electoral Process & Pluralism', range: [-0.5, 10.5] },
                yaxis: { title: 'Functioning of Government', range: [-0.5, 10.5] },
                hovermode: 'closest'
            });
        }
        
        // Feature importance chart
        const featureImportance = [
            {feature: 'Electoral Process', importance: 0.85},
            {feature: 'Civil Liberties', importance: 0.78},
            {feature: 'Functioning of Government', importance: 0.75},
            {feature: 'Political Culture', importance: 0.62},
            {feature: 'Political Participation', importance: 0.58}
        ];
        
        Plotly.newPlot('importance-chart', [{
            x: featureImportance.map(d => d.importance),
            y: featureImportance.map(d => d.feature),
            type: 'bar',
            orientation: 'h',
            marker: {color: '#8884d8'}
        }], {
            title: 'Feature Importance in Clustering',
            xaxis: { title: 'Importance Score' },
            margin: { l: 150 }
        });
        
        // ARI comparison chart
        Plotly.newPlot('ari-chart', [{
            x: ['K-Means', 'Hierarchical'],
            y: [0.78, 0.72],
            type: 'bar',
            marker: {
                color: ['#8884d8', '#82ca9d']
            }
        }], {
            title: 'Adjusted Rand Index Comparison',
            yaxis: { 
                title: 'ARI Score',
                range: [0, 1] 
            }
        });
        
        // Set up event listeners
        document.getElementById('colorby').addEventListener('change', function() {
            createScatterPlot(this.value);
        });
        
        document.getElementById('reset').addEventListener('click', function() {
            createScatterPlot('cluster');
            document.getElementById('colorby').value = 'cluster';
        });
        
        // Initialize
        createScatterPlot();
    </script>
</body>
</html>